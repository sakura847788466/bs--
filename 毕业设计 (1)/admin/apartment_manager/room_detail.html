<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>学生宿舍管理系统</title>
    <link rel="stylesheet" href="../static/css/bootstrap.css">
    <script src="../static/js/jquery-3.3.1.js"></script>
    <script src="../static/js/bootstrap.js"></script>
</head>

<body>
    <div style="display:flex;align-items: center;">
        <img src="../static/img/log.png">
        <h1 style="margin-left:200px;">学&nbsp生&nbsp宿&nbsp舍&nbsp后&nbsp台&nbsp管&nbsp理系&nbsp统</h1>
    </div>

    <ul class="nav nav-tabs" style="background:orange">
        <li class="tab_item" style="margin-left:100px;"><a onmouseover="this.style.background='white';this.style.color='orange';" onmouseleave="if(this.parentNode.className == 'tab_item'){this.style.background='orange';this.style.color='white';}" href="index.html" style="color:white">首页</a></li>
        <li class="tab_item active"><a style="background:white;color:orange;" onmouseover="this.style.background='white';this.style.color='orange';" onmouseleave="if(this.parentNode.className == 'tab_item'){this.style.background='orange';this.style.color='white';}" href="room.html"
                style="color:white">学生宿舍管理</a></li>
        <li class="tab_item"><a onmouseover="this.style.background='white';this.style.color='orange';" onmouseleave="if(this.parentNode.className == 'tab_item'){this.style.background='orange';this.style.color='white';}" href="student.html" style="color:white">学生信息管理</a></li>
        <li class="tab_item"><a onmouseover="this.style.background='white';this.style.color='orange';" onmouseleave="if(this.parentNode.className == 'tab_item'){this.style.background='orange';this.style.color='white';}" href="repair.html" style="color:white">宿舍报修信息管理</a></li>
        <li class="tab_item"><a onmouseover="this.style.background='white';this.style.color='orange';" onmouseleave="if(this.parentNode.className == 'tab_item'){this.style.background='orange';this.style.color='white';}" href="cost.html" style="color:white">水电费管理</a></li>
        <li class="tab_item"><a onmouseover="this.style.background='white';this.style.color='orange';" onmouseleave="if(this.parentNode.className == 'tab_item'){this.style.background='orange';this.style.color='white';}" href="entry_exit.html" style="color:white">物品出入管理</a></li>
        <li class="tab_item"><a onmouseover="this.style.background='white';this.style.color='orange';" onmouseleave="if(this.parentNode.className == 'tab_item'){this.style.background='orange';this.style.color='white';}" href="modify_password.html" style="color:white">修改密码</a></li>
        <div role="presentation" style="float:right;margin:10px 100px 10px 0"><a style="color:white" href="../user/login.html">注销</a></div>
        <div role="presentation" style="float:right;margin:10px 20px 10px 0"><a style="color:white" href="javascript:;">欢迎您：D2宿舍管理员</a>
        </div>
    </ul>

    <div style="margin:auto;width:1000px;height:100%">

        <!-- <script src="../static/js/room_detail.js/"></script> -->

        <div class="panel panel-warning" style="background:	#F2F2F2;margin-top:30px;">
            <div class="panel-heading">
                <font style="vertical-align: inherit;">
                    <font style="vertical-align: inherit;">D2615可容纳：1人已入住：3人&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><label><a id="add_text" href="javascript:;" style="color:orange" onclick="add()"><font style="vertical-align: inherit;">添加入住</font></a></label></font>
                <label id="error" style="color:red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label><a id="add_text" href="javascript:;" style="color:orange" onclick="add()"><font style="vertical-align: inherit;"></font></a></label></div>
            <div class="panel-body" style="margin-left:50px;color:orange">
                <table width="600px" style="table-layout:fixed;">
                    <tbody>
                        <tr>
                            <th style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">学号</font>
                                </font>
                            </th>
                            <th style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">姓名</font>
                                </font>
                            </th>
                            <th style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">性别</font>
                                </font>
                            </th>
                            <th style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">班别</font>
                                </font>
                            </th>
                            <th style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">- </font>
                                </font>
                            </th>
                        </tr>
                        <form action="/apartment/room/checkin/D2615/" method="post" onsubmit="return check_error()"></form>
                        <input type="hidden" name="csrfmiddlewaretoken" value="HYqQI0BAfJ1e8apeViEpigpfkO24PzihE5qO6MSD6PhPj91j3fU0luXDqozRWGRj">
                        <tr id="add" style="display:none;">
                            <td style="text-align:center">
                                <input type="number" id="student_id" name="student_id" required="" class="form-control" style="border:none;" onchange="find_student()">
                                <p id="student_error" style="color:red;"></p>
                            </td>
                            <td id="student_name" style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">- </font>
                                </font>
                            </td>
                            <td id="student_sex" style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">- </font>
                                </font>
                            </td>
                            <td id="student_class" style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">- </font>
                                </font>
                            </td>
                            <th style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;"><input style="background:orange;border:0" type="submit" class="btn btn-primary" value="入住"></font>
                                </font>
                            </th>
                        </tr>


                        <tr>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">2016120592</font>
                                </font>
                            </td>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">叶振锠</font>
                                </font>
                            </td>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">男</font>
                                </font>
                            </td>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">16嵌入式技术与应用1班</font>
                                </font>
                            </td>
                            <th style="text-align:center">
                                <a href="/apartment/room/remove/9/D2615/" style="color:orange;">
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">搬出</font>
                                    </font>
                                </a>
                            </th>
                        </tr>


                        <tr>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">2016120577</font>
                                </font>
                            </td>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">江宇</font>
                                </font>
                            </td>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">男</font>
                                </font>
                            </td>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">16嵌入式技术与应用1班</font>
                                </font>
                            </td>
                            <th style="text-align:center">
                                <a href="/apartment/room/remove/10/D2615/" style="color:orange;">
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">搬出</font>
                                    </font>
                                </a>
                            </th>
                        </tr>


                        <tr>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">2016120578</font>
                                </font>
                            </td>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">张旭伟</font>
                                </font>
                            </td>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">男</font>
                                </font>
                            </td>
                            <td style="text-align:center">
                                <font style="vertical-align: inherit;">
                                    <font style="vertical-align: inherit;">16嵌入式技术与应用1班</font>
                                </font>
                            </td>
                            <th style="text-align:center">
                                <a href="/apartment/room/remove/17/D2615/" style="color:orange;">
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">搬出</font>
                                    </font>
                                </a>
                            </th>
                        </tr>


                    </tbody>
                </table>
            </div>
        </div>

        <script>
            function add() {
                var obj = document.getElementById("add");
                var obj2 = document.getElementById("add_text");
                if (1 == 0) {
                    document.getElementById("error").innerHTML = "入住人数已满！"
                } else {
                    if (obj.style.display == "none") {
                        obj.style.display = ""
                        obj2.innerHTML = "取消入住";
                    } else {
                        obj.style.display = "none";
                        obj2.innerHTML = "添加入住";
                    }
                }

            }


            function find_student() {
                var xhr;
                if (window.XMLHttpRequest) {
                    xhr = new XMLHttpRequest();
                }
                value = document.getElementById("student_id").value;
                url = "/apartment/room/find_student/" + value;
                xhr.open("GET", url, true);

                xhr.onreadystatechange = function() {

                    if (xhr.readyState == 4 && xhr.status == 200) {
                        var data = xhr.responseText;
                        data = JSON.parse(data);
                        var obj = document.getElementById("student_error");
                        if (data.status == 0) {
                            obj.innerHTML = "已入住其他宿舍！不可重复入住";
                            document.getElementById("student_id").innerHTML = data.id;
                            document.getElementById("student_name").innerHTML = data.name;
                            document.getElementById("student_sex").innerHTML = data.sex;
                            document.getElementById("student_class").innerHTML = data.class;
                        } else if (data.status == 1) {
                            obj.innerHTML = "";
                            document.getElementById("student_name").innerHTML = data.name;
                            document.getElementById("student_sex").innerHTML = data.sex;
                            document.getElementById("student_class").innerHTML = data.class;
                        } else if (data.status == 2) {
                            obj.innerHTML = "学生不存在";
                            document.getElementById("student_name").innerHTML = "";
                            document.getElementById("student_sex").innerHTML = "--";
                            document.getElementById("student_class").innerHTML = "--";
                        }
                    }
                }
                xhr.send();
            }

            function check_error() {
                var obj = document.getElementById("student_error");
                if (obj.innerHTML == "") {
                    return true;
                } else {
                    return false;
                }
            }
        </script>

    </div>
</body>

</html>